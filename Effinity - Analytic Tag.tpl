___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "Effinity - Analytic Tag",
  "brand": {
    "id": "brand_dummy",
    "displayName": "",
    "thumbnail": "data:image/png;base64,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\u003d"
  },
  "description": "Tag to put on all pages of the website to measure visits",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "merchantId",
    "displayName": "Merchant Id",
    "simpleValueType": true,
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      },
      {
        "type": "POSITIVE_NUMBER"
      }
    ]
  },
  {
    "type": "TEXT",
    "name": "firstPartyDomain",
    "displayName": "First party Domain",
    "simpleValueType": true,
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      },
      {
        "type": "REGEX",
        "args": [
          "partner*"
        ]
      }
    ]
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

const log = require('logToConsole');
const injectScript = require('injectScript');

const onSuccess = () => {
  log('Effinity Analytics : Script loaded successfully.');
  data.gtmOnSuccess();
};

const onFailure = () => {
  log('Effinity Analytics : Script load failed.');
  data.gtmOnFailure();
};

injectScript("https://"+data.firstPartyDomain+"/ct/an"+data.merchantId+".js", onSuccess, onFailure, 'effinity_analytics');


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": []
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 27/04/2023 12:15:46


